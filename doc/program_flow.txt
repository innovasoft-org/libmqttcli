@startuml
!pragma useVerticalIf off
start
:Initializing TCP/IP;

:Configuring the timer;

#lightblue:Initializing the library;

#lightblue:Configuring the library;

:Establishing TCP/IP connection;

while(stopped?) is (false)
if(timer raised?) then (yes)
  :Setting empty data;
  repeat 
    #lightblue:Processing the data;
    if(Result not equalt to MQTT_SUCCESS nor MQTT_PENDING_DATA?) then (yes)
      :Error processing;
    else if(data not empty?) then (yes)
      :Non-blocking sending;<<Output>>
    endif
  repeat while(Result equal to MQTT_PENDING_DATA?)
endif

:Non-blocking receiving; <<Input>>

if(data received?) then (yes)
  :Setting the data;
  repeat 
    #lightblue:Processing the data;
    if(Result not equalt to MQTT_SUCCESS nor MQTT_PENDING_DATA?) then (yes)
      :Error processing;
    else if(data not empty?) then (yes)
      :Non-blocking sending;<<Output>>
    endif
  repeat while(Result equal to MQTT_PENDING_DATA?)
endif
endwhile

#lightblue:Releasing the library resources;

:Closing TCP/IP connection;

stop
@enduml
